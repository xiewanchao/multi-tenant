# Optional hardening example:
# only allow business backend pods (httpbin in this tutorial) to accept traffic
# from the gateway namespace and same namespace. This helps ensure backends trust
# metadata headers only when requests come through AgentGateway.
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: httpbin-allow-from-agentgateway
  namespace: httpbin
spec:
  podSelector:
    matchLabels:
      app: httpbin
  policyTypes:
    - Ingress
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: agentgateway-system
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: httpbin
